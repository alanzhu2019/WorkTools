<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>排程数据</title>
    <!--引入vue.js-->
    <script src="js/vue.js"></script>

    <!--引入 element js css-->
    <link rel="stylesheet" href="element-ui/lib/theme-chalk/index.css">
    <script src="element-ui/lib/index.js"></script>
    <script src="js/axios-0.18.0.js"></script>
    <style>
        .el-table .warning-row {
            background: oldlace;
        }

        .el-table .success-row {
            background: #f0f9eb;
        }
    </style>
</head>
<body>

<div id="app">
    <template >
        <el-table
                :data="tableData"
                style="width: 100%"
                :row-class-name="tableRowClassName"
                highlight-current-row
                @current-change="handleCurrentChange"
                @selection-change="handleSelectionChange">
            <el-table-column
                    type="selection"
                    width="55"
                    label="全选">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="code"
                    label="排程">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="charlinecode"
                    label="线体">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="materialcode"
                    label="物料">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="moqty"
                    label="订单量">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="schedulingqty"
                    label="排程量">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="inputqty"
                    label="投入量">
            </el-table-column>
            <el-table-column
                    align="center"
                    prop="completeqty"
                    label="产出量">
            </el-table-column>
            <el-table-column label="操作">
                <template slot-scope="{row}">
                    <el-button
                            size="mini"
                            @click="">编辑</el-button>
<!--                    <el-button-->
<!--                            size="mini"-->
<!--                            type="danger"-->
<!--                            @click="handleDelete(scope.$index, scope.row)">删除</el-button>-->

                    <el-popconfirm
                            title="确定要删除当前行吗？"
                            @confirm="deleteCode(row)">
                        <el-button
                             size="mini"
                             type="danger"
                             slot="reference">
                            删除</el-button>
                    </el-popconfirm>

                </template>
            </el-table-column>
        </el-table>
    </template>
</div>


</body>

<script>
    new Vue({
        el: "#app",
        data() {
            return {
                tableData: {},

                //     [{
                //     code: 'YDMW9211072A-001',
                //     mo: 'YDMW9211072A',
                //     charLineCode: 'WH_ASM013',
                //     materialCode:'SA78D21306',
                //
                // }]
                currentRow: null,
                multipleSelection: []
            }

        },
        methods: {

            //编辑
            handleEdit(){

            },

            //删除
            deleteCode(row){
            let _this = this
             axios({
                 method: 'post',
                 url: 'http://localhost/WorkTools/schedule/deleteByCode',
                 data: row.code
             }).then(function (resp) {
                 if (resp.data == 'success'){
                     _this.$message({
                         message: '删除成功',
                         type: 'success'
                     });
                     _this.loadTablData()
                 }else {
                     _this.$message.error('删除失败' + resp.data);
                 }
             })
            },

            tableRowClassName({row, rowIndex}) {
                if (rowIndex % 2 === 0) {
                    return '';
                } else{
                    return 'success-row';
                }
            },
            handleCurrentChange(val) {
                this.currentRow = val;
            },
            handleSelectionChange(val) {
                this.multipleSelection = val;
            },

            loadTablData(){
                let _this = this
                axios({
                    method: "get",
                    url: "http://localhost/WorkTools/schedule/selectAll"
                }).then(function (resp) {
                    _this.tableData = resp.data
                })
            }
        },


        mounted(){
            this.loadTablData()
        }

    })

</script>
</html>